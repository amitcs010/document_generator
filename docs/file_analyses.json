[
  {
    "purpose": "This SQL script creates or recreates the `mdl_customers` table by selecting all customer-related columns from `src_customers`.",
    "source_tables": [
      "src_customers"
    ],
    "target_tables": [
      "mdl_customers"
    ],
    "transformations": [
      "Direct column selection"
    ],
    "business_logic": "All customer records and their specified attributes are replicated from the source table without modification or filtering.",
    "dependencies": [
      "src_customers"
    ],
    "file_name": "mdl_customers.sql",
    "file_type": "script",
    "file_path": "models/mdl_customers.sql"
  },
  {
    "purpose": "This SQL script creates or recreates the mdl_products table by selecting all columns from src_products.",
    "source_tables": [
      "src_products"
    ],
    "target_tables": [
      "mdl_products"
    ],
    "transformations": [
      "Direct column selection from source to target"
    ],
    "business_logic": "This script stages product data by replicating all columns from the source without applying specific business rules within the query itself.",
    "dependencies": [
      "src_products table"
    ],
    "file_name": "mdl_products.sql",
    "file_type": "script",
    "file_path": "models/mdl_products.sql"
  },
  {
    "purpose": "Creates and populates a materialized data layer table for sales, including calculated total value and standardized date format.",
    "source_tables": [
      "src_sales"
    ],
    "target_tables": [
      "mdl_sales"
    ],
    "transformations": [
      "Calculates 'total_value' as quantity multiplied by price",
      "Casts 'sale_date' to a date data type"
    ],
    "business_logic": "Only includes sales records where both quantity and price are greater than zero.",
    "dependencies": [
      "src_sales"
    ],
    "file_name": "mdl_sales.sql",
    "file_type": "script",
    "file_path": "models/mdl_sales.sql"
  },
  {
    "purpose": "This stored procedure refreshes three analytical model tables (mdl_sales, mdl_customers, mdl_products) by loading and transforming data from their respective source tables.",
    "source_tables": [
      "src_sales",
      "src_customers",
      "src_products"
    ],
    "target_tables": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "transformations": [
      "Calculate total_value by multiplying quantity and price for sales data.",
      "Cast sale_date to date type for sales data."
    ],
    "business_logic": "Sales records are included only if both quantity and price are greater than zero.",
    "dependencies": [
      "N/A"
    ],
    "file_name": "sp_load_models.sql",
    "file_type": "stored_procedure",
    "file_path": "stored_procedures/sp_load_models.sql"
  },
  {
    "purpose": "This SQL creates a view that combines sales transaction data with corresponding customer and product details.",
    "source_tables": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "target_tables": [
      "vw_sales_customer_product"
    ],
    "transformations": [
      "Joins sales data with customer data using customer_id",
      "Joins sales data with product data using product_id",
      "Selects specific attributes from sales, customer, and product entities"
    ],
    "business_logic": "The view consolidates individual sales records by linking them to the customer who made the purchase and the product that was sold, providing a comprehensive sales overview.",
    "dependencies": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "file_name": "sp_sales_cust_prod.sql",
    "file_type": "view",
    "file_path": "views/sp_sales_cust_prod.sql"
  },
  {
    "purpose": "This SQL script creates the 'src_products' table to store product information.",
    "source_tables": [],
    "target_tables": [
      "src_products"
    ],
    "transformations": [
      "product_id is an auto-incrementing BIGSERIAL primary key",
      "price is stored as a NUMERIC with 10 total digits and 2 decimal places",
      "updated_at automatically defaults to the current timestamp upon row insertion/update"
    ],
    "business_logic": "Establishes a schema for product data, including unique identification, name, category, price with specific precision, and an automatically managed timestamp for record updates.",
    "dependencies": [],
    "file_name": "src_products.sql",
    "file_type": "script",
    "file_path": "source/src_products.sql"
  },
  {
    "purpose": "script SQL file",
    "source_tables": [],
    "target_tables": [
      "if"
    ],
    "transformations": [
      "Data transformation"
    ],
    "business_logic": "See SQL file for details",
    "dependencies": [],
    "file_name": "src_sales.sql",
    "file_type": "script",
    "file_path": "source/src_sales.sql"
  },
  {
    "purpose": "script SQL file",
    "source_tables": [],
    "target_tables": [
      "if"
    ],
    "transformations": [
      "Data transformation"
    ],
    "business_logic": "See SQL file for details",
    "dependencies": [],
    "file_name": "src_customers.sql",
    "file_type": "script",
    "file_path": "source/src_customers.sql"
  }
]