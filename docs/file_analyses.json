[
  {
    "purpose": "Creates or refreshes the `mdl_customers` table with selected customer data from the `src_customers` table.",
    "source_tables": [
      "src_customers"
    ],
    "target_tables": [
      "mdl_customers"
    ],
    "transformations": [
      "Direct column selection from source to target"
    ],
    "business_logic": "Populates a modeled customer table with raw customer data.",
    "dependencies": [
      "src_customers table"
    ],
    "file_name": "mdl_customers.sql",
    "file_type": "script",
    "file_path": "models/mdl_customers.sql"
  },
  {
    "purpose": "This SQL script creates or recreates the `mdl_products` table by selecting specific columns directly from the `src_products` table.",
    "source_tables": [
      "src_products"
    ],
    "target_tables": [
      "mdl_products"
    ],
    "transformations": [
      "Direct column selection"
    ],
    "business_logic": "The script directly mirrors product data including ID, name, category, price, and update timestamp from a source table to a model table without applying any specific business rules or calculations.",
    "dependencies": [
      "src_products table"
    ],
    "file_name": "mdl_products.sql",
    "file_type": "script",
    "file_path": "models/mdl_products.sql"
  },
  {
    "purpose": "Creates or recreates the mdl_sales table by selecting and transforming sales data from src_sales.",
    "source_tables": [
      "src_sales"
    ],
    "target_tables": [
      "mdl_sales"
    ],
    "transformations": [
      "Calculates total_value from quantity and price",
      "Casts sale_date to date type"
    ],
    "business_logic": "Includes only sales records where both quantity and price are greater than zero.",
    "dependencies": [
      "src_sales"
    ],
    "file_name": "mdl_sales.sql",
    "file_type": "script",
    "file_path": "models/mdl_sales.sql"
  },
  {
    "purpose": "This procedure refreshes three analytical model tables: sales, customers, and products, by extracting data from their respective source tables.",
    "source_tables": [
      "src_sales",
      "src_customers",
      "src_products"
    ],
    "target_tables": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "transformations": [
      "Calculates total_value as quantity multiplied by price for sales records",
      "Casts sale_date to a DATE type for sales records"
    ],
    "business_logic": "Sales records are filtered to include only those where quantity and price are positive.",
    "dependencies": [
      "src_sales",
      "src_customers",
      "src_products"
    ],
    "file_name": "sp_load_models.sql",
    "file_type": "stored_procedure",
    "file_path": "stored_procedures/sp_load_models.sql"
  },
  {
    "purpose": "Creates a view consolidating sales transaction details with customer and product information.",
    "source_tables": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "target_tables": [
      "vw_sales_customer_product"
    ],
    "transformations": [
      "Performs a LEFT JOIN between mdl_sales and mdl_customers on customer_id.",
      "Performs a LEFT JOIN between mdl_sales and mdl_products on product_id.",
      "Selects specific columns from sales, customer, and product tables."
    ],
    "business_logic": "This view combines sales transaction data with customer and product master data, ensuring all sales records are present even if a matching customer or product is not found due to LEFT JOINs.",
    "dependencies": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "file_name": "sp_sales_cust_prod.sql",
    "file_type": "view",
    "file_path": "views/sp_sales_cust_prod.sql"
  },
  {
    "purpose": "Defines a new table named `src_products` to store detailed product information.",
    "source_tables": [],
    "target_tables": [
      "src_products"
    ],
    "transformations": [
      "Define `product_id` as an auto-incrementing primary key (`BIGSERIAL`)",
      "Enforce `NUMERIC(10,2)` data type for the `price` column",
      "Set the `updated_at` column to the current timestamp by default upon record creation/update"
    ],
    "business_logic": "To establish a structured schema for recording product details including unique identification, name, category, price, and a timestamp of last modification.",
    "dependencies": [],
    "file_name": "src_products.sql",
    "file_type": "script",
    "file_path": "source/src_products.sql"
  },
  {
    "purpose": "script SQL file",
    "source_tables": [],
    "target_tables": [
      "if"
    ],
    "transformations": [
      "Data transformation"
    ],
    "business_logic": "See SQL file for details",
    "dependencies": [],
    "file_name": "src_sales.sql",
    "file_type": "script",
    "file_path": "source/src_sales.sql"
  },
  {
    "purpose": "script SQL file",
    "source_tables": [],
    "target_tables": [
      "if"
    ],
    "transformations": [
      "Data transformation"
    ],
    "business_logic": "See SQL file for details",
    "dependencies": [],
    "file_name": "src_customers.sql",
    "file_type": "script",
    "file_path": "source/src_customers.sql"
  }
]