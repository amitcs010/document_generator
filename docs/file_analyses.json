[
  {
    "purpose": "This SQL script creates or recreates the mdl_customers table by selecting all relevant customer data directly from src_customers.",
    "source_tables": [
      "src_customers"
    ],
    "target_tables": [
      "mdl_customers"
    ],
    "transformations": [
      "Direct column selection and data replication"
    ],
    "business_logic": "Replicates raw customer data from a source table into a model table for further use.",
    "dependencies": [
      "src_customers"
    ],
    "file_name": "mdl_customers.sql",
    "file_type": "script",
    "file_path": "models/mdl_customers.sql"
  },
  {
    "purpose": "Creates or recreates the `mdl_products` table by directly copying all specified columns from the `src_products` table.",
    "source_tables": [
      "src_products"
    ],
    "target_tables": [
      "mdl_products"
    ],
    "transformations": [
      "Table recreation",
      "Direct column selection"
    ],
    "business_logic": "All specified product data from the source table `src_products` is copied to the target table `mdl_products` without any filtering, aggregation, or modification.",
    "dependencies": [
      "src_products table"
    ],
    "file_name": "mdl_products.sql",
    "file_type": "script",
    "file_path": "models/mdl_products.sql"
  },
  {
    "purpose": "Creates and populates the `mdl_sales` table with processed sales data, including calculated total value and type-casted sale date, filtering for valid quantities and prices.",
    "source_tables": [
      "src_sales"
    ],
    "target_tables": [
      "mdl_sales"
    ],
    "transformations": [
      "Calculates `total_value` as `quantity * price`",
      "Casts `sale_date` to a `date` data type",
      "Filters records to include only sales with `quantity > 0` and `price > 0`"
    ],
    "business_logic": "Only valid sales records with positive quantity and price are included in the model.",
    "dependencies": [
      "src_sales"
    ],
    "file_name": "mdl_sales.sql",
    "file_type": "script",
    "file_path": "models/mdl_sales.sql"
  },
  {
    "purpose": "This stored procedure refreshes three model tables (sales, customers, and products) by recreating them from their respective source tables.",
    "source_tables": [
      "src_sales",
      "src_customers",
      "src_products"
    ],
    "target_tables": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "transformations": [
      "Calculates total_value for sales as quantity multiplied by price",
      "Casts sale_date to a date type for sales"
    ],
    "business_logic": "Sales model data is filtered to include only records where quantity and price are greater than zero.",
    "dependencies": [
      "src_sales",
      "src_customers",
      "src_products"
    ],
    "file_name": "sp_load_models.sql",
    "file_type": "stored_procedure",
    "file_path": "stored_procedures/sp_load_models.sql"
  },
  {
    "purpose": "Creates a view consolidating sales transaction details with customer and product information.",
    "source_tables": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "target_tables": [
      "vw_sales_customer_product"
    ],
    "transformations": [
      "Data is joined from three different tables based on common IDs (customer_id, product_id) using LEFT JOINs.",
      "Specific columns are selected from each joined table."
    ],
    "business_logic": "The view combines sales records with customer and product attributes, ensuring all sales are included even if a matching customer or product record is not found.",
    "dependencies": [
      "mdl_sales",
      "mdl_customers",
      "mdl_products"
    ],
    "file_name": "sp_sales_cust_prod.sql",
    "file_type": "view",
    "file_path": "views/sp_sales_cust_prod.sql"
  },
  {
    "purpose": "This SQL script creates a table named src_products to store product information with an auto-incrementing ID, name, category, price, and a default timestamp.",
    "source_tables": [],
    "target_tables": [
      "src_products"
    ],
    "transformations": [
      "product_id is an auto-incrementing primary key (BIGSERIAL)",
      "price is defined with NUMERIC(10,2) precision and scale",
      "updated_at defaults to the current timestamp (NOW())"
    ],
    "business_logic": "The table is designed to capture core product attributes, ensuring each product has a unique identifier and tracking its creation or last update time.",
    "dependencies": [],
    "file_name": "src_products.sql",
    "file_type": "script",
    "file_path": "source/src_products.sql"
  },
  {
    "purpose": "script SQL file",
    "source_tables": [],
    "target_tables": [
      "if"
    ],
    "transformations": [
      "Data transformation"
    ],
    "business_logic": "See SQL file for details",
    "dependencies": [],
    "file_name": "src_sales.sql",
    "file_type": "script",
    "file_path": "source/src_sales.sql"
  },
  {
    "purpose": "script SQL file",
    "source_tables": [],
    "target_tables": [
      "if"
    ],
    "transformations": [
      "Data transformation"
    ],
    "business_logic": "See SQL file for details",
    "dependencies": [],
    "file_name": "src_customers.sql",
    "file_type": "script",
    "file_path": "source/src_customers.sql"
  }
]